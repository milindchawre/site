
<!doctype html>

<html xmlns="http://www.w3.org/1999/xhtml"  lang="en">

    <head>

        
        <meta charset="UTF-8" />

        
        <meta name="viewport" content="width=device-width, initial-scale=1"/>

                
        <title> 
             Develop and Test Your Code Directly in Kubernetes Using Okteto  
        </title>
        
        
            <link href="https://milindchawre.github.io/site/index.xml" rel="alternate" type="application/rss+xml" title="Milind&#39;s Blog" />
        

        
        <link rel="stylesheet" href="/site/css/style.css"/>

        
        
            <link rel='stylesheet' href='https://milindchawre.github.io/site/css/custom.css'>
        
        
    </head>

    <body>



<section class="section">
  <div class="container">
    <nav id="nav-main" class="nav">
      <div id="nav-name" class="nav-left">
        <a id="nav-anchor" class="nav-item" href="https://milindchawre.github.io/site/">
          <h1 id="nav-heading" class="title is-4">Milind&#39;s Blog</h1>
        </a>
      </div>
      <div class="nav-right">
        
        
        <nav id="nav-items" class="nav-item level is-mobile">
          <a class="level-item" aria-label="about" href='/site/about'
           rel='noopener'>
            <span class="icon">
              <i class>

<svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12" y2="8"></line>
    
  </svg>
</i>
            </span>
          </a>
          <a class="level-item" aria-label="resume" href='https://milindchawre.github.io'
           target='_blank'  rel='noopener'>
            <span class="icon">
              <i class>

<svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M22.125 2.25H1.875A1.127 1.127 0 0 0 .75 3.375v17.25a1.127 1.127 0 0 0 1.125 1.125H6v-2.757c0-.351.192-.656.477-.817l.005-.002l4.311-2.396l-1.419-3.546V9.376a2.625 2.625 0 1 1 5.25 0v2.856l-1.419 3.546l4.312 2.396c.29.163.482.469.482.819v2.757h4.125a1.127 1.127 0 0 0 1.125-1.125V3.375a1.127 1.127 0 0 0-1.125-1.125zm-.375 18H19.5v-1.257c0-.911-.5-1.706-1.241-2.124l-.012-.006l-3.157-1.755l1.035-2.588V9.376a4.125 4.125 0 0 0-8.25 0v3.144l1.035 2.588l-3.157 1.755a2.441 2.441 0 0 0-1.253 2.13v1.257H2.25V3.75h19.5z" fill="black"/>
    
  </svg>
</i>
            </span>
          </a>
          <a class="level-item" aria-label="email" href='mailto:milindchawre@outlook.com'
           target='_blank'  rel='noopener'>
            <span class="icon">
              <i class>

<svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
    <polyline points="22,6 12,13 2,6"/>
    
  </svg>
</i>
            </span>
          </a>
          <a class="level-item" aria-label="github" href='https://github.com/milindchawre'
           target='_blank'  rel='noopener'>
            <span class="icon">
              <i class>

<svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/>
    
  </svg>
</i>
            </span>
          </a>
          <a class="level-item" aria-label="linkedin" href='https://linkedin.com/in/milind-chawre'
           target='_blank'  rel='noopener'>
            <span class="icon">
              <i class>

<svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path stroke-width="1.8" d="m5.839218,4.101561c0,1.211972 -0.974141,2.194011 -2.176459,2.194011s-2.176459,-0.982039 -2.176459,-2.194011c0,-1.211094 0.974141,-2.194011 2.176459,-2.194011s2.176459,0.982917 2.176459,2.194011zm0.017552,3.94922l-4.388022,0l0,14.04167l4.388022,0l0,-14.04167zm7.005038,0l-4.359939,0l0,14.04167l4.360816,0l0,-7.370999c0,-4.098413 5.291077,-4.433657 5.291077,0l0,7.370999l4.377491,0l0,-8.89101c0,-6.915523 -7.829986,-6.66365 -9.669445,-3.259423l0,-1.891237z"/>
    
  </svg>
</i>
            </span>
          </a>
          <a class="level-item" aria-label="stackoverflow" href='https://stackoverflow.com/users/6790948/mchawre?tab=profile'
           target='_blank'  rel='noopener'>
            <span class="icon">
              <i class>

<svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M18.986 21.865v-6.404h2.134V24H1.844v-8.539h2.13v6.404h15.012zM6.111 19.731H16.85v-2.137H6.111v2.137zm.259-4.852l10.48 2.189l.451-2.07l-10.478-2.187l-.453 2.068zm1.359-5.056l9.705 4.53l.903-1.95l-9.706-4.53l-.902 1.936v.014zm2.715-4.785l8.217 6.855l1.359-1.62l-8.216-6.853l-1.35 1.617l-.01.001zM15.751 0l-1.746 1.294l6.405 8.604l1.746-1.294L15.749 0h.002z" fill="white"/>
    
  </svg>
</i>
            </span>
          </a>
          <a class="level-item" aria-label="twitter" href='https://twitter.com/@milindchawre'
           target='_blank'  rel='noopener'>
            <span class="icon">
              <i class>

<svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"/>
    
  </svg>
</i>
            </span>
          </a>
          <a class="level-item" aria-label="facebook" href='https://facebook.com/milind.chawre'
           target='_blank'  rel='noopener'>
            <span class="icon">
              <i class>

<svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"/>
    
  </svg>
</i>
            </span>
          </a>
          <a class="level-item" aria-label="rss" href='/site/index.xml'
           target='_blank'  rel='noopener'>
            <span class="icon">
              <i class>

<svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle>
    
  </svg>
</i>
            </span>
          </a></nav>
        
      
      </div>
    </nav>

    <nav class="nav">
      

      
    </nav>

  </div>
</section>

<section class="section">
    
    <div class="container">
    
        
            
<div class="subtitle tags is-6 is-pulled-right">
    
        
<a class="subtitle is-6" href="/tags/kubernetes/">#kubernetes</a>



  
  | <a class="subtitle is-6" href="/tags/okteto/">#okteto</a>
  
  | <a class="subtitle is-6" href="/tags/java/">#java</a>
  
  | <a class="subtitle is-6" href="/tags/vscode/">#vscode</a>
  
  | <a class="subtitle is-6" href="/tags/cloud-native-development/">#cloud-native-development</a>
  


    
</div>



<h2 class="subtitle is-6">
    
    
        June 17, 2020 | 23:54
    
</h2>



<h1 class="title">Develop and Test Your Code Directly in Kubernetes Using Okteto</h1>

<div class="content">

    
    <p><em>This blog was originally featured as a <a href="https://www.civo.com/learn/okteto-a-tool-to-develop-and-test-your-code-directly-in-kubernetes">guide</a> in civo cloud community.</em></p>
<h4 id="introduction">Introduction</h4>
<p><a href="https://okteto.com">Okteto</a> is an <a href="https://github.com/okteto/okteto">open source</a> tool to develop and test your code directly in Kubernetes. In this guide will walk you through how to develop Java application on a Kubernetes cluster using Okteto.</p>
<h5 id="defining-the-problem">Defining the Problem</h5>
<p>Systems based on microservice architecture have many advantages like scalability, resilience, fault tolerance and so on. But they are also harder to setup locally as a development environment due to their very nature. You need to run several services with different runtimes on your local workstation. Also running these multiple services will eat away the available computer resources.</p>
<p>Kubernetes has become industry standard to run production workloads. But developing in Kubernetes presents some challenges. Typically, you would finish writing your code and package it in a Docker image, push that image to a registry, followed by pulling the container to your cluster for deployment, checking everything works as expected, and then repeating the process for new code. This is not only slow and tedious, but it means that it would be difficult to take advantage of useful features of tools such as debuggers, immediately-visible changes on reload, and so on.</p>
<h5 id="solution---a-development-platform-in-the-cloud">Solution - a Development Platform in the Cloud</h5>
<p><a href="https://github.com/okteto/okteto">Okteto</a> is an answer to your problem. Okteto transforms your Kubernetes cluster into a fully-featured development platform. It allows you to develop and test your code directly in Kubernetes while taking full advantage of tools like Maven and Gradle, popular frameworks, hot reloads, incremental builds, IDE debuggers and so on.</p>
<h4 id="application-development-with-okteto">Application Development with Okteto</h4>
<p>Lets see how to develop a <a href="https://github.com/milindchawre/okteto-java-maven-demo">sample Java application</a> using Okteto.</p>
<p><em>NOTE: This guide focus on developing Java application on Kubernetes, but there are other guides to develop with your favorite programming language such <a href="https://okteto.com/docs/samples/node">Node</a>, <a href="https://okteto.com/docs/samples/python">Python</a>, <a href="https://okteto.com/docs/samples/golang">Go</a>, <a href="https://okteto.com/docs/samples/ruby/index.html">Ruby</a>, etc.</em></p>
<h5 id="prerequisite"><strong>Prerequisite</strong></h5>
<p>Before you begin, you will need following things:</p>
<ul>
<li>Code Editor/IDE</li>
<li><a href="https://kubernetes.io/docs/concepts/overview/what-is-kubernetes/">kubernetes cluster</a></li>
<li><code>KUBECONFIG</code> file pointing to your kubernetes cluster, where the application will be deployed.</li>
<li><a href="https://kubernetes.io/docs/tasks/tools/install-kubectl/">kubectl</a> to communicate with your cluster.</li>
</ul>
<p><em>If you don&rsquo;t have kubernetes cluster ready, <a href="https://www.civo.com/signup">sign up</a> to civo for their managed Kubernetes beta which is completely free. You can also check out Okteto Cloud offering that gives you a free kubernetes namespace, explained more in this guide below.</em></p>
<h5 id="step-1-deploying-the-java-app"><strong>Step 1: Deploying the Java App</strong></h5>
<p>Get the source code of our sample Java app.</p>
<pre tabindex="0"><code>$ git clone https://github.com/milindchawre/okteto-java-maven-demo
$ cd okteto-java-maven-demo
</code></pre><p><em>Note: The <a href="https://github.com/milindchawre/okteto-java-maven-demo/blob/master/kubernetes.yaml">kubernetes.yaml</a> file contains the <a href="https://kubernetes.io/docs/concepts/workloads/controllers/deployment/">kubernetes manifest</a> to deploy this app.</em></p>
<p>Lets deploy it on Kubernetes.</p>
<pre tabindex="0"><code># Make sure `KUBECONFIG` env is pointing to your kubernetes cluster
$ kubectl apply -f kubernetes.yaml
deployment.apps/demo created
</code></pre><p>Your sample Java application is now running on Kubernetes.</p>
<h5 id="step-2-install-the-okteto-cli"><strong>Step 2: Install the Okteto CLI</strong></h5>
<p>The <a href="https://github.com/okteto/okteto">Okteto CLI</a> allows you to develop your applications directly in Kubernetes while taking advantage of well-known tooling for your particular choice of language. For Java, these include Maven/Gradle, Spring Boot and your favourite IDE&rsquo;s debugger functionality. It also speeds up our development cycle instead of going through the typical development workflow described above.</p>
<p>Install the <a href="https://github.com/okteto/okteto">Okteto CLI</a> by running the following command:</p>
<p><em><code>MacOS/Linux</code></em></p>
<pre tabindex="0"><code>$ curl https://get.okteto.com -sSfL | sh
</code></pre><p>You can also install via <a href="https://brew.sh/">brew</a> by running:</p>
<pre tabindex="0"><code>$ brew install okteto
</code></pre><p><em><code>Windows</code></em></p>
<p>Download the <a href="https://downloads.okteto.com/cli/okteto.exe">executable</a> and add it to your <code>$PATH</code>.</p>
<p>You can also install via <a href="https://scoop.sh/">scoop</a> by running:</p>
<pre tabindex="0"><code>$ scoop install okteto
</code></pre><p><em><code>Github</code></em></p>
<p>Alternatively, you can directly download the binary <a href="https://github.com/okteto/okteto/releases">from GitHub</a>.</p>
<h5 id="step-3-start-your-development-environment-in-kubernetes"><strong>Step 3: Start your development environment in Kubernetes</strong></h5>
<p>With the sample Java application deployed as above, run the following command:</p>
<pre tabindex="0"><code>$ okteto up 

 +  Development environment activated
 âœ“ Files synchronized
   Namespace: default
   Name: demo
   Forward: 8080 -&gt; 8080
            8088 -&gt; 8088

...
</code></pre><p>The command <code>okteto up</code> starts a <a href="https://okteto.com/docs/reference/development-environment/index.html">Kubernetes development environment</a>, which means:</p>
<ul>
<li>It connects to your remote kubernetes cluster</li>
<li>Goes to the deployment that has your application and changes the docker image with a different one that contains the required dev tools to build, test, debug and run a Java application.</li>
<li>Sets up automatic <a href="https://okteto.com/docs/reference/file-synchronization">file synchronization</a> in both directions so that to keep your changes up-to-date between your local filesystem and your application pods.</li>
<li>Sets up port-forwarding in both directions both for your app (8080 :- the application) and for your debugging tools (8088 :- the debugger).</li>
<li>Setups a tiny SSH server in the pod to make it easy to work with SSH based tools (i.e. remote workspaces in Visual studio Code). Now you can build, test, and run your application as if you were doing it on your local machine.</li>
</ul>
<p>You can customize the way Okteto manipulates your code, using <a href="https://github.com/milindchawre/okteto-java-maven-demo/blob/master/okteto.yml">okteto.yml</a> <a href="https://okteto.com/docs/reference/manifest/index.html">manifest file</a>. You can also use the file <code>.stignore</code> to <a href="https://okteto.com/docs/reference/file-synchronization/index.html#ignoring-files">skip files</a> from file synchronization. This is useful to save you from synchronising data that doesn&rsquo;t need to be moved.</p>
<p>The first time you run the application, Maven will compile your application. Wait for this process to finish.</p>
<p>Okteto automatically forwards port 8080 from your local computer to the remote development environment, making it accessible via localhost. Test your application by running the command below in a local shell:</p>
<pre tabindex="0"><code>$ curl localhost:8080
Hello world!
</code></pre><p>Or visit to <code>http://localhost:8080</code> on your browser. You should see the text <code>Hello World!</code> like in the image below:</p>
<p><img src="https://github.com/milindchawre/civo-k8s/raw/master/blog/okteto/images/okteto1.png" alt="okteto1"></p>
<h5 id="step-4-develop-directly-in-kubernetes"><strong>Step 4: Develop directly in Kubernetes</strong></h5>
<p>Open <a href="https://github.com/milindchawre/okteto-java-maven-demo/blob/master/src/main/java/com/example/demo/RestHelloWorld.java">src/main/java/com/example/demo/RestHelloWorld.java</a> in your favorite local IDE and modify the response message on <a href="https://github.com/milindchawre/okteto-java-maven-demo/blob/master/src/main/java/com/example/demo/RestHelloWorld.java#L11">line 11</a> to something else like to <em>Hello world from the cluster!</em>. Now save your changes.</p>
<p><img src="https://github.com/milindchawre/civo-k8s/raw/master/blog/okteto/images/okteto2.png" alt="okteto2"></p>
<p>As soon as you save the code, your IDE will auto compile only the necessary <code>*.class</code> files that will be synchronized by Okteto to your application in Kubernetes. Take a look at the remote shell and notice how the changes are detected by Spring Boot and automatically hot reloaded. Please note that to enable Spring Boot hot reloads you need to import the <code>spring-boot-devtools</code> dependency in your application, which in the case of this tutorial, we already did <a href="https://github.com/milindchawre/okteto-java-maven-demo/blob/master/pom.xml#L42-L45">here</a>.</p>
<p>Call your application to validate the changes:</p>
<pre tabindex="0"><code>$ curl localhost:8080
Hello world from the cluster!
</code></pre><p><img src="https://github.com/milindchawre/civo-k8s/raw/master/blog/okteto/images/okteto3.png" alt="okteto3"></p>
<p>Great! Your code changes are instantly applied to Kubernetes. No commit, build or push required! ðŸ˜Ž</p>
<p><img src="https://github.com/milindchawre/civo-k8s/raw/master/blog/okteto/images/okteto4.png" alt="okteto4"></p>
<p>The end result is that the remote Kubernetes cluster seems local to your workstation. When you edit your code on your workstation and as soon as you save it, the changes go to the remote cluster and your app instantly updates (taking advantage of any hot-reload mechanism if present like <a href="https://docs.spring.io/spring-boot/docs/2.0.x/reference/html/howto-hotswapping.html">springboot hot swapping</a> in our case). This whole process happens in an instant. There is no need to build any docker image or apply any kubernetes manifests. All of this is taken care by Okteto.</p>
<h5 id="step-5-debug-directly-in-kubernetes"><strong>Step 5: Debug directly in Kubernetes</strong></h5>
<p>Okteto also allows you to debug your applications directly from your IDE. Letâ€™s see how it works in <a href="https://code.visualstudio.com/">VS Code</a>. To enable debug mode, define the following as a <a href="https://github.com/milindchawre/okteto-java-maven-demo/blob/master/pom.xml#L54-L56">JVM arguments</a> in your Maven configuration files:</p>
<pre tabindex="0"><code>-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=8088
</code></pre><p>Open <a href="https://code.visualstudio.com/docs/java/java-debugging#_configure">launch.json</a> to modify the debug configuration. Add <a href="https://code.visualstudio.com/docs/java/java-debugging#_attach">configuration</a> to attach to a remote debugger.</p>
<p><img src="https://github.com/milindchawre/civo-k8s/raw/master/blog/okteto/images/okteto5.png" alt="okteto5"></p>
<p>Now, add a breakpoint in your code and click on Run Debug. Go back to the browser and reload the page. The code execution will halt at your breakpoint. You can now inspect the code, trace the function calls, look at available variables, and so on.</p>
<p><img src="https://github.com/milindchawre/civo-k8s/raw/master/blog/okteto/images/okteto6.png" alt="okteto6"></p>
<p>So the code runs in remote Kubernetes cluster, but you can debug it from your local workstation. ðŸ˜‰</p>
<h5 id="step-6-wrapping-up"><strong>Step 6: Wrapping Up</strong></h5>
<p>Once you are done with the development, run <a href="https://okteto.com/docs/reference/cli/index.html#down">okteto down</a> command. It deactivates your development environment, stops the file synchronization service and restores your previous deployment configuration.</p>
<pre tabindex="0"><code>$ okteto down
 +  Development environment deactivated
 i  Run &#39;okteto push&#39; to deploy your code changes to the cluster
</code></pre><h5 id="okteto-cloud">Okteto Cloud</h5>
<p>It&rsquo;s possible to use Okteto for local development even when you don&rsquo;t have your own kubernetes cluster. <a href="https://cloud.okteto.com/#/login">Okteto Cloud</a> gives you free access to secure Kubernetes namespaces, fully integrated with remote development capabilities. For more info, refer the official <a href="https://okteto.com/docs/cloud/index.html">documentation</a>.</p>
<p><img src="https://github.com/milindchawre/civo-k8s/raw/master/blog/okteto/images/okteto7.png" alt="okteto7"></p>
<p>There is also a hosted version called <a href="https://okteto.com/enterprise/">Okteto enterprise</a> that companies can use on their own premises instead of Okteto Cloud.</p>
<h5 id="conclusion">Conclusion</h5>
<p>Okteto transforms your Kubernetes cluster into a fully-featured development platform. It lets you develop your applications directly in Kubernetes. This way it helps in lot of different ways:</p>
<ul>
<li>You don&rsquo;t need to install compilers, runtimes, docker or kubernetes locally on your workstation anymore.</li>
<li>No need to build docker images and create deployments everytime you make changes in the code.</li>
<li>Test your application as fast as you can type, resulting in a faster feedback loop.</li>
<li>No more compute resources wasted in your machine. The resources are limited by the power of the cloud.</li>
<li>While developing with Okteto you can still use your favorite IDE and debugging/testing tools with features like incremental builds and hot-reloads as supported by your programming language.</li>
<li>The remote Kubernetes clusters can be used as a local filesystem/environment on your workstation.</li>
<li>You avoid the <code>works on my machine</code> problem as your application is developed inside the cluster in which it is destined to be deployed.</li>
<li>It solves challenges faced by multiple developers when working simultaneously on a common set of services. Having a separate dedicated Kubernetes namespace for each developer helps in resolving many issues.</li>
<li>Reduce integration issues by developing in a more production-like environment.</li>
</ul>
<p>For more information, check out the <a href="https://github.com/okteto/okteto">Okteto project on GitHub</a> and refer to this <a href="https://okteto.com/docs/getting-started/index.html">quickstart guide</a>. Also check out the <a href="https://github.com/okteto/samples">Okteto samples repository</a> to see how to use Okteto with different programming languages and debuggers.</p>
<p>If you found this guide useful, let me know on twitter at <a href="https://twitter.com/milindchawre">@milindchawre</a>.</p>


    
    
        <div class="related">


<h3>Similar articles</h3>

<ul>
	
	<li><a href="/site/blog/fairwinds-goldilocks-kubernetes-resource-recommendation-tool/">Fairwinds Goldilocks : Kubernetes Resource Recommendation Tool</a></li>
	
	<li><a href="/site/blog/setting-up-polaris-on-kubernetes/">Setting Up Polaris on Kubernetes</a></li>
	
</ul>


</div>
    

</div>


        

    </div>

</section>



<section class="section">
  <div class="container has-text-centered">
    <p>Â© 2020</p>
    
      <p>Powered by <a href="https://gohugo.io/">Hugo</a> &amp; <a href="https://github.com/pavel-pi/kiss-em">Kiss'Em</a>.</p>
    
  </div>
</section>

</body>
</html>

